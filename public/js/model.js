const questionsData = {
    rompehielos: { truths: ["Si pudieras tener un superpoder, Â¿cuÃ¡l serÃ­a?", "Â¿CuÃ¡l es la comida mÃ¡s rara que has probado?", "Si pudieras cenar con cualquier personaje histÃ³rico, Â¿quiÃ©n serÃ­a?", "Si tuvieras que ser un animal, Â¿cuÃ¡l serÃ­as y por quÃ©?", "Â¿CuÃ¡l fue el Ãºltimo libro que leÃ­ste?", "Â¿QuÃ© es lo mÃ¡s amable que alguien ha hecho por ti?", "Â¿CuÃ¡l es tu talento mÃ¡s inÃºtil?", "Â¿QuÃ© canciÃ³n siempre te pone de buen humor?", "Si pudieras vivir en cualquier Ã©poca, Â¿cuÃ¡l elegirÃ­as?", "Â¿CuÃ¡l es el mejor regalo que has recibido?", "Â¿CuÃ¡l es la aplicaciÃ³n de tu mÃ³vil que mÃ¡s usas?", "Si solo pudieras comer una cosa por el resto de tu vida, Â¿quÃ© serÃ­a?", "Â¿CuÃ¡l es tu recuerdo mÃ¡s feliz de la infancia?", "Â¿QuÃ© es algo que siempre te hace reÃ­r sin importar quÃ©?", "Si pudieras ser un experto instantÃ¡neo en cualquier campo, Â¿cuÃ¡l elegirÃ­as?", "Â¿Crees en fantasmas o en lo paranormal?", "Â¿CuÃ¡l es el trabajo de tus sueÃ±os?", "Si pudieras diseÃ±ar una atracciÃ³n de un parque temÃ¡tico, Â¿cÃ³mo serÃ­a?", "Â¿QuÃ© es algo que la mayorÃ­a de la gente no sabe sobre ti?", "Â¿Prefieres la playa o la montaÃ±a? Â¿Por quÃ©?"], dares: ["Haz tu mejor imitaciÃ³n de un animal.", "Habla como un pirata hasta tu prÃ³ximo turno.", "Crea un apretÃ³n de manos secreto con la persona de tu derecha.", "Intenta hacer beatbox durante 30 segundos.", "Nombra 5 cosas que podrÃ­as comprar en un supermercado que empiecen con la letra 'P'.", "Usa un cojÃ­n como si fuera tu mascota por el resto del juego.", "Haz una pose de superhÃ©roe y mantenla por un minuto.", "Canta el estribillo de una canciÃ³n muy cursi.", "Intenta tocarte la nariz con la lengua.", "Habla con susurros hasta tu prÃ³ximo turno.", "Intenta dibujar un cÃ­rculo perfecto con tu mano no dominante.", "Hazle cosquillas a la persona a tu derecha durante 15 segundos.", "Canta el estribillo de la canciÃ³n infantil que mÃ¡s recuerdes.", "Haz una imitaciÃ³n de tu emoji favorito.", "Intenta mantener el equilibrio sobre un pie con los ojos cerrados durante 30 segundos.", "PropÃ³n un brindis muy solemne por el objeto mÃ¡s insignificante de la mesa.", "Intenta hacer reÃ­r a la persona mÃ¡s seria del grupo.", "Lee el Ãºltimo mensaje de texto que recibiste en voz alta.", "Haz diez saltos de tijera mientras cantas tu canciÃ³n favorita.", "Habla como Yoda hasta tu prÃ³ximo turno."] },
    classic: { truths: ["Â¿CuÃ¡l es la cosa mÃ¡s vergonzosa que te ha pasado en una cita?", "Â¿Alguna vez has mentido en tu currÃ­culum?", "Â¿CuÃ¡l es el rumor mÃ¡s loco que has oÃ­do sobre ti?", "Â¿Has espiado el mÃ³vil de tu pareja?", "Si tuvieras que besar a alguien en esta sala, Â¿quiÃ©n serÃ­a?", "Â¿QuÃ© es lo mÃ¡s ilegal que has hecho?", "Â¿Has roto algo en casa de alguien y no lo has dicho?", "Â¿CuÃ¡l es tu mayor 'red flag' en una pareja?", "Â¿Te has hecho pasar por enfermo para evitar un compromiso?", "Â¿Alguna vez te ha gustado la pareja de un amigo?", "Â¿Alguna vez te has meado en una piscina siendo adulto?", "Â¿CuÃ¡l es el regalo mÃ¡s feo que has recibido y has fingido que te encantaba?", "Â¿Has tenido alguna vez un sueÃ±o erÃ³tico con alguien presente?", "Â¿QuÃ© es lo mÃ¡s vergonzoso que tus padres te han pillado haciendo?", "Si tuvieras que borrar una red social para siempre, Â¿cuÃ¡l serÃ­a?", "Â¿Alguna vez has culpado a alguien por algo que tÃº hiciste?", "Â¿QuÃ© es lo mÃ¡s estÃºpido por lo que has discutido con una pareja?", "Â¿Revisas el perfil de tu ex en redes sociales?", "Â¿CuÃ¡l es tu 'Guilty Pleasure' musical?", "Â¿Te has comido algo que se te cayÃ³ al suelo aplicando la 'regla de los 5 segundos'?"], dares: ["Llama a un contacto al azar y intenta venderle un producto imaginario.", "Deja que el grupo te ponga un apodo vergonzoso para el resto de la noche.", "Haz una imitaciÃ³n de alguien famoso hasta que los demÃ¡s adivinen.", "Publica una foto de tus pies en tus redes sociales.", "Intercambia una prenda de ropa con la persona a tu izquierda.", "Haz una llamada en broma a una tienda.", "EnvÃ­a 'te echo de menos' al tercer contacto de tu WhatsApp.", "ActÃºa como si estuvieras borracho por las prÃ³ximas 2 rondas.", "Come una cucharada de un condimento de la nevera.", "Haz 20 sentadillas mientras nombras personajes de Disney.", "EnvÃ­a un mensaje a tu crush (o ex) diciendo 'estaba pensando en ti'.", "Ponte un cubito de hielo en el pantalÃ³n y aguanta hasta que se derrita.", "Haz una pasarela de moda improvisada mostrando tu 'look' de hoy.", "Deja que el grupo escriba una palabra en tu frente. No puedes verla hasta el final del juego.", "Haz 20 flexiones o sentadillas.", "Come una rodaja de limÃ³n o lima sin hacer ninguna mueca.", "Deja que alguien te haga cosquillas en los pies por 30 segundos.", "Hazle una broma telefÃ³nica a un amigo que no estÃ© en la fiesta.", "QuÃ­tate los calcetines y Ãºsalos como guantes por el resto de la ronda.", "Canta una canciÃ³n de cuna a una almohada."] },
    sinfiltro: { truths: ["Â¿Con quiÃ©n de los presentes has fantaseado?", "Â¿CuÃ¡l es el lugar mÃ¡s pÃºblico donde has tenido relaciones?", "Â¿Alguna vez has estado con mÃ¡s de una persona a la vez?", "Â¿QuÃ© es lo mÃ¡s 'kinky' que has probado?", "Muestra el Ãºltimo vÃ­deo porno que viste.", "Â¿CuÃ¡l es tu postura sexual favorita y por quÃ©?", "Â¿Has usado juguetes sexuales? Describe tu favorito.", "Confiesa una infidelidad (propia o que conozcas de cerca).", "Â¿QuÃ© es lo que mÃ¡s te excita de la persona a tu derecha?", "Â¿Te has acostado con la ex pareja de un amigo/a?", "Â¿QuÃ© es lo mÃ¡s rÃ¡pido que has tardado en acostarte con alguien desde que lo conociste?", "Â¿Alguna vez te han pillado masturbÃ¡ndote?", "Â¿Has tenido sexo en casa de tus padres mientras ellos estaban allÃ­?", "Describe el orgasmo mÃ¡s intenso que has tenido.", "Â¿Prefieres dominar o ser dominado/a en la cama?", "Â¿Has probado el BDSM o alguna prÃ¡ctica similar?", "Â¿QuÃ© es algo que te da vergÃ¼enza pedir en la cama pero que te encantarÃ­a probar?", "Si tuvieras que calificar tus habilidades como amante del 1 al 10, Â¿quÃ© nota te pondrÃ­as?", "Â¿CuÃ¡l es la mayor locura que has hecho por amor o por deseo?", "Describe el beso mÃ¡s memorable que has dado o recibido."], dares: ["Dale un beso francÃ©s de 20 segundos a alguien elegido por el grupo.", "QuÃ­tate una prenda de ropa.", "Haz un 'lap dance' de 30 segundos a la persona de tu elecciÃ³n.", "Deja que alguien te dÃ© una nalgada.", "ChÃºpale el dedo a la persona que te parezca mÃ¡s sexy.", "SusÃºrrale al oÃ­do a alguien la descripciÃ³n de lo que le harÃ­as en la cama.", "Elige a dos personas para que se den un beso (pico).", "Muerde suavemente el lÃ³bulo de la oreja de la persona de tu izquierda.", "QuÃ­tale una prenda de ropa a alguien usando solo la boca.", "Haz un 'body shot' en el cuello o abdomen de alguien.", "Elige a una persona y quÃ­tale una prenda de ropa con la boca.", "Hazle un 'body shot' a alguien (sal, tequila/shot, limÃ³n).", "Elige a una persona. Ambos deben beber un trago mientras se miran fijamente a los ojos. El primero que se rÃ­a, bebe otro.", "Huele el cuello de cada jugador y adivina quÃ© perfume o lociÃ³n llevan.", "QuÃ­tate los pantalones y juega sin ellos durante 2 rondas.", "Dale de comer algo a alguien en la boca de forma sensual.", "Escribe el nombre de tu celebrity crush en el abdomen de alguien con tu dedo.", "Hazle una foto sexy a tu pie y ponla como foto de perfil de WhatsApp durante 10 minutos.", "Elige a una persona para que te susurre su fantasÃ­a mÃ¡s secreta. No puedes contÃ¡rsela a nadie.", "Haz un ranking de los jugadores de la sala segÃºn lo bien que crees que besan."] },
    prohibido: { truths: ["Â¿Con quiÃ©n de esta sala tendrÃ­as el sexo mÃ¡s animal y por quÃ©?", "Â¿CuÃ¡l es el secreto mÃ¡s oscuro que sabes de alguien presente?", "Describe la fantasÃ­a mÃ¡s tabÃº que tienes involucrando a alguien del grupo.", "Â¿QuÃ© es lo mÃ¡s degradante que has hecho por placer?", "Si tuvieras que elegir, Â¿te acostarÃ­as con la pareja de tu mejor amigo?", "Muestra al grupo la conversaciÃ³n mÃ¡s caliente que tengas en tu mÃ³vil.", "Describe con detalle la Ãºltima vez que te masturbaste.", "Â¿Has tenido alguna vez una experiencia sexual que podrÃ­a considerarse ilegal?", "Â¿CuÃ¡l es la parte del cuerpo de alguien en esta sala que mÃ¡s te gustarÃ­a lamer?", "Â¿Alguna vez has pagado por sexo?", "Â¿CuÃ¡l es la fantasÃ­a sexual mÃ¡s detallada que tienes con alguien de esta sala?", "Â¿Has tenido un orgasmo pensando en alguien que no debÃ­as?", "Â¿QuÃ© es lo mÃ¡s vergonzoso que has hecho para satisfacerte sexualmente?", "Â¿Has espiado a alguien mientras se cambiaba o se duchaba?", "Â¿CuÃ¡l es la parte de tu propio cuerpo que mÃ¡s te excita?", "Si tuvieras que hacer un trÃ­o con dos personas de esta sala, Â¿a quiÃ©nes elegirÃ­as?", "Â¿CuÃ¡l es el secreto de otro jugador que sabes que, si lo revelaras, cambiarÃ­a la dinÃ¡mica del grupo?", "Â¿Has tenido sexo con mÃ¡s de una persona en un periodo de 24 horas?", "Â¿QuÃ© es lo mÃ¡s cerca que has estado de engaÃ±ar a tu pareja?", "Â¿Has tenido alguna vez una fantasÃ­a con alguien del mismo sexo? Describe la fantasÃ­a."], dares: ["QuÃ­tate la ropa hasta quedar en ropa interior y juega asÃ­ hasta tu prÃ³ximo turno.", "Elige a una persona. Tienes permiso para tocar sus genitales por encima de la ropa durante 30 segundos.", "Lame una lÃ­nea de sal desde el cuello hasta el ombligo de otro jugador.", "Da un beso francÃ©s a cada persona en la sala.", "Intercambia una prenda de ropa interior con la persona de enfrente.", "Realiza un striptease de 1 minuto para el grupo.", "Deja que el grupo te vende los ojos y te dÃ© besos en el cuello. Tienes que adivinar quiÃ©n fue.", "ArrodÃ­llate y actÃºa como la mascota de alguien por una ronda.", "Elige a dos personas. Tienen que meterse juntos en un armario por 5 minutos.", "El grupo escribe una palabra en una parte de tu cuerpo cubierta por la ropa. Tienes que adivinarla solo con el tacto.", "Elige a una persona. Ambos deben quitarse una prenda de ropa y ponÃ©rsela al otro.", "Besa a la persona de tu izquierda. El beso debe empezar en la mejilla y bajar hasta la clavÃ­cula.", "Elige a una persona. Tienes que quitarle los zapatos y los calcetines y masajearle los pies durante un minuto.", "Elige a dos jugadores. Deben meterse juntos en un armario o un espacio pequeÃ±o durante 3 minutos.", "QuÃ­tate la camiseta y deja que alguien dibuje algo en tu espalda con su dedo. Tienes que adivinar quÃ© es.", "Dale una lamida al cuello de cada jugador presente.", "Elige a alguien. Tienen que darse de comer el uno al otro un trozo de fruta de la forma mÃ¡s erÃ³tica posible.", "SiÃ©ntate en el suelo. La persona a tu derecha tiene que pasar por encima de ti muy lentamente.", "Elige a alguien y dale un beso con los ojos vendados. El grupo te guiarÃ¡ hasta esa persona.", "Elige a la persona que peor te caiga del grupo y dale un beso en la boca."] }
};

const generalCards = [
    { type: 'wildcard', title: "El Imitador", description: "Elige a alguien y debes imitarlo durante 3 rondas. Si fallas, bebes." }, { type: 'wildcard', title: "Cascada", description: "Â¡Todos a beber! Empiezas tÃº y nadie para hasta que tÃº lo hagas." }, { type: 'wildcard', title: "Rey del Pulgar", description: "Eres el 'Thumb Master'. Pon tu pulgar en la mesa en cualquier momento. El Ãºltimo en copiarte, bebe." }, { type: 'bomb', title: "Shot en Cadena", description: "Tomas 1 shot puro. Luego, eliges a otro para que tome 2." }, { type: 'bomb', title: "Muro de la VergÃ¼enza", description: "El grupo escribe un estado vergonzoso para que lo publiques en tus redes." }, { type: 'bomb', title: "El Exiliado", description: "No puedes hablar ni reÃ­r durante la prÃ³xima ronda. Si lo haces, bebes." }
];

const prohibitedCards = [
    { type: 'wildcard', title: "CÃ­rculo del Beso", description: "Empiezas tÃº, besas a la persona de tu derecha, y asÃ­ sucesivamente. El Ãºltimo beso, de vuelta a ti, es con lengua." }, { type: 'wildcard', title: "Siete Minutos: Ropa Opcional", description: "Elige a alguien. Vayan a un cuarto por 7 minutos. Al menos una prenda principal debe ser retirada por cada uno." }, { type: 'wildcard', title: "Rey/Reina de la Noche", description: "Tienes el poder. Da UNA orden del Modo Prohibido a CUALQUIER jugador. No se puede negar." }, { type: 'bomb', title: "ConfesiÃ³n Forzada", description: "Entrega tu telÃ©fono. El grupo tiene 3 minutos para leer en voz alta cualquier conversaciÃ³n que elijan." }, { type: 'bomb', title: "Ruleta de Ropa Interior", description: "Debes quitarte la ropa interior y dÃ¡rsela a la persona de tu izquierda. No la recuperas hasta el final." }, { type: 'bomb', title: "El Reto Definitivo", description: "El jugador anterior inventa un reto extremo para ti. No puedes negarte." }
];

const finalBombGeneral = {
    title: "El Camino del CampeÃ³n ğŸ†",
    description: "Para ganar, debes superar 3 mini-retos diseÃ±ados por los demÃ¡s jugadores. Si fallas uno, pierdes 3 puntos y el juego continÃºa."
};

const finalBombProhibido = {
    title: "El Peaje del Placer ğŸ˜ˆ",
    description: "Para ganar, debes elegir una de dos opciones. Si te niegas a ambas, pierdes la mitad de tus puntos.",
    options: {
        a: "OpciÃ³n A: La Ofrenda (Dar placer)",
        b: "OpciÃ³n B: La SumisiÃ³n (Recibir placer)"
    }
};

const gameState = {
    mode: 'classic', players: [], turnOrder: [], currentPlayerIndex: 0, isCompetitive: false,
    customTruths: [], customDares: [], activeQuestions: { truth: [], dare: [] }, skipTurn: false
};

function _shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function _reloadQuestions() {
    const truths = questionsData[gameState.mode]?.truths || [];
    const dares = questionsData[gameState.mode]?.dares || [];
    gameState.activeQuestions.truth = [...truths, ...gameState.customTruths];
    gameState.activeQuestions.dare = [...dares, ...gameState.customDares];
    _shuffleArray(gameState.activeQuestions.truth);
    _shuffleArray(gameState.activeQuestions.dare);
}

export function setMode(newMode) { gameState.mode = newMode; }
export function setCompetitive(isCompetitive) { gameState.isCompetitive = isCompetitive; }
export function addPlayer(name, gender) {
    if (name && !gameState.players.find(p => p.name === name)) {
        gameState.players.push({ name, gender, drinks: 0, points: 0 });
        return true;
    }
    return false;
}
export function removePlayer(name) { gameState.players = gameState.players.filter(p => p.name !== name); }
export function addCustomQuestion(type, text) {
    if (type === 'truth') gameState.customTruths.push(text);
    else gameState.customDares.push(text);
}
export function prepareGame() {
    gameState.turnOrder = [...gameState.players];
    _shuffleArray(gameState.turnOrder);
    _reloadQuestions();
}
export function nextPlayer() { gameState.currentPlayerIndex = (gameState.currentPlayerIndex + 1) % gameState.turnOrder.length; }
export function getQuestion(type) {
    let pool = gameState.activeQuestions[type];
    if (pool.length === 0) {
        _reloadQuestions();
        pool = gameState.activeQuestions[type];
    }
    return pool.pop();
}
export function triggerCard() {
    let pool = gameState.mode === 'prohibido' ? [...generalCards, ...prohibitedCards] : generalCards;
    const card = pool[Math.floor(Math.random() * pool.length)];
    if(card.effect) card.effect(gameState);
    return card;
}
export function getFinalBomb() {
    if (gameState.isCompetitive) {
        const player = gameState.turnOrder[gameState.currentPlayerIndex];
        if (player.points >= 8) {
            if (Math.random() < 0.75) {
                return gameState.mode === 'prohibido' ? finalBombProhibido : finalBombGeneral;
            }
        }
    }
    return null;
}
export function addDrinkToCurrentPlayer() {
    const player = gameState.turnOrder[gameState.currentPlayerIndex];
    if (player) player.drinks++;
}
export function updatePointsForCurrentPlayer(wasSuccessful) {
    const player = gameState.turnOrder[gameState.currentPlayerIndex];
    if (player && wasSuccessful) player.points += 2;
}
export function getSkipPunishment() {
    switch (gameState.mode) {
        case 'sinfiltro': return "Debes tomar 2 SHOTS PUROS.";
        case 'prohibido': return "Debes tomar 3 SHOTS PUROS.";
        default: return "Debes tomar 1 SHOT PURO.";
    }
}
export function reset() {
    Object.assign(gameState, {
        mode: 'classic', players: [], turnOrder: [], currentPlayerIndex: 0, isCompetitive: false,
        customTruths: [], customDares: [], activeQuestions: { truth: [], dare: [] }, skipTurn: false
    });
}

export default gameState;